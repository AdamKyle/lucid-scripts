!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();t.exports=function(){function t(){n(this,t)}return i(t,[{key:"getAllEventIcons",value:function(){var t=[];return $gameMap._events.forEach(function(e){if(void 0!==e)for(var n=e.page().list.length,i=0;i<n;i++)if(108===e.page().list[i].code){var o=e.page().list[i].parameters[0].match(/<eventIcon: (.*)>/i);o&&t.push({event_id:e._eventId,icon_id:Number(o[1])})}}),t}}]),t}()},function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,i)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(i)},s=n(0);t.exports=function(t){function e(t){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.eventIconDetails=t,n}return r(e,t),a(e,[{key:"initialize",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this),$gamePlayer.actionIconTarget=$gamePlayer.actionIconTarget||{event_id:0,icon_id:0},this._iconIndex=0,this.z=100,this.changeBitmap($gamePlayer.actionIconTarget),this._tileWidth=$gameMap.tileWidth(),this._tileHeight=$gameMap.tileHeight(),this._offsetX=-Window_Base._iconWidth/2,this._offsetY=-38,this.anchor.y=1,this._float=.1,this.mod=.2,this.mapEventsIcons=new s,lucidScripts.lucidEventIcon.needRefresh=!0}},{key:"changeBitmap",value:function(t){if(t.event_id<=0?this._iconIndex=0:this._iconIndex=t.icon_id,!(this._iconIndex<=0)){var e=Window_Base._iconWidth,n=Window_Base._iconHeight,i=this._iconIndex%16*e,o=Math.floor(this._iconIndex/16)*n,r=ImageManager.loadSystem("IconSet");this.bitmap=new Bitmap(e,n),this.bitmap.blt(r,i,o,e,n,0,0),this.scale.y=.1,this.opacity=0,this.mod=.2,this._float=.1,lucidScripts.lucidEventIcon.needRefresh=!1}}},{key:"updateOpacity",value:function(){$gameMap.isEventRunning()&&$gameMap._interpreter.eventId()===this.eventIconDetails.event_id?this.opacity-=40:this.opacity=255}},{key:"update",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),$gameMap.requestRefresh(),lucidScripts.lucidEventIcon.needRefresh&&void 0!==this.eventIconDetails&&($gamePlayer.actionIconTarget=this.eventIconDetails),this._iconIndex!==$gamePlayer.actionIconTarget.icon_id&&this.changeBitmap($gamePlayer.actionIconTarget),this._iconIndex<=0||(this.x=$gameMap.event($gamePlayer.actionIconTarget.event_id).screenX()+this._offsetX,this.y=$gameMap.event($gamePlayer.actionIconTarget.event_id).screenY()+this._offsetY+this._float,this.scale.y=Math.min(this.scale.y+.1,1),this.updateOpacity(),this._float+=this.mod,this._float<-.1?this.mod=Math.min(this.mod+.01,.2):this._float>=.1&&(this.mod=Math.max(this.mod+-.01,-.2)))}}]),e}(Sprite)},function(t,e,n){var i=n(1),o=n(0);window.lucidScripts=window.lucidScripts||{},lucidScripts.lucidEventIcon={needRefresh:!1},function(){var t=Game_System.prototype.initialize;Game_System.prototype.initialize=function(){t.call(this),lucidScripts.lucidEventIcon.needRefresh=!0};var e=Game_Map.prototype.requestRefresh;Game_Map.prototype.requestRefresh=function(t){e.call(this,t),lucidScripts.lucidEventIcon.needRefresh=!0};var n=Spriteset_Map.prototype.createLowerLayer;Spriteset_Map.prototype.createLowerLayer=function(){n.call(this),this.createActionIconSprite()},Spriteset_Map.prototype.createActionIconSprite=function(){(new o).getAllEventIcons().forEach(function(t){this["_eventiconSprite_"+t.event_id]=new i(t),this._tilemap.addChild(this["_eventiconSprite_"+t.event_id])},this)}}()}]);