/*:
 * @plugindesc Allow you to set your Own EXP for each class.
 * @author Eviticous
 *
 * @help
 *
 * Must give credit. Can be used in commercial Games.
 *
 * Compatibility Issues: ???
 *
 * Place: <xpFormula: "level * 100"> in a class note box.
 *
 * This will mean that for each level they will need that level X 100,
 * so for level 3 its 3 * 100 = 300 exp before they reach level 4.
 *
 * You can also do things like: <expFormula: 100> which will set the
 * the level to 100 for all levels. This is similar to that of Final Fantasy
 * Tactics Advanced (and other such games).
 *
 * If your value is 0, we will default to the default exp system.
 *
 * Scaling across levels?
 *
 * The way this script works is you set up either a single digit value for
 * all levels up to max, or you set up a formula that then scales based on your
 * level and what you need to attain the next level.
 *
 * Example formulas:
 *
 * Notice how all the formulas below use "" around their expression,
 * this is needed only if you are creating an expression.
 *
 * If you are not creating an expression, and you want the exp to be
 * a constant 100 or X, where X is a valid integer, then you can leave
 * off the quotes.
 *
 * <expFormula: "level + 100 + (level * 1.333)">
 *
 * This states to take the next level, add 100 to it, add the level
 * multiplied by 1/3.
 *
 * <expFormula: "level + 500 * pow(level, 6)">
 *
 * This states to take the level, multiply it by 500 and then multiply that
 * by the level to the power of 6.
 *
 * <expFormula: "level + 500 * pow(level, 6) + exp level">
 *
 * This states to take the level, multiply it by 500 and then multiply that
 * by the level to the power of 6.
 *
 * Words you can use that are translated by the plugin:
 *
 * - level: This is a variable thats replaced by the actual level
 * - pow(x, y): x to the power of y
 * - exp x: Exponential x, also known as e^x
 * - ceil x: The ceiling of x
 * - floor x: The floor of x
 * - round x: Round the value of X either up or down
 *
 * Note: Your formula is automatically rounded either up or down to the
 * nearest whole integer.
 *
 * Example Formula using all supported words:
 *
 * <expFormula: "round (level + 500 * pow(level, 6) + exp level +
 *      ceil (1000 * 1.18) - 100 + floor (1000 * 1.18))">
 *
 * Evaluation Information:
 *
 * Your formulas will be pr-compiled down to bedmass, so in the example above:
 *
 * <expFormula: "level + 500 * pow(level, 6)">
 *
 * Becomes: (level + (500 * pow(level, 6))
 *
 */
!function(t){function e(r){if(n[r])return n[r].exports;var s=n[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function i(t){for(var e,n,r,i={args:[]};e=o(t);){var a=e,u=E(a,2);if(n=u[0],r=u[1],"object"===(void 0===n?"undefined":s(n))){i=w({},i,n);var h=r.ofType("COMMA"),p=r.ofType("KEY")&&r.advance().ofType("KEYVALSEP");if(h)t=r.advance();else{if(!p)return[i,r];t=r}}else{if(i=w({},i,{args:i.args.concat(n)}),r.empty||"COMMA"!=r.get().type)return[i,r];t=r.advance()}}return[i,t]}function o(t){return a(t)||u(t)}function a(t){if(t.length<3)return null;if(!t.ofType("KEY")||!t.advance().ofType("KEYVALSEP"))return null;var e=u(t.advance(2));return e?[r({},t.get().token,e[0]),t.advance(3)]:null}function u(t){if(t.empty)return null;var e=t.get(),n=e.token;switch(e.type){case"NUMBER":return[Number(n),t.advance()];case"QUOTEDSTRING":return[R(n),t.advance()];case"BARESTRING":case"KEY":return[n,t.advance()];case"BOOLEAN":return["true"===n.toLowerCase(),t.advance()];default:return null}}function h(t){if(t.length<3)return null;if(!t.ofType("BRA"))return null;var e=i(t.advance());if(!e)return null;var n=E(e,2),r=n[0],s=n[1];return s.ofType("KET")?[r,s.advance()]:null}function p(t){if(t.length<3)return null;var e=t.advance();if(!t.ofType("BRA")||!e.ofType("IDENTIFIER"))return null;var n=i(t.advance(2));if(!n)return null;var r=E(n,2),s=r[0],o=r[1];if(!o.ofType("KET"))return null;var a=e.get().token,u=l(function(t){return c(["BRA","SLASH","IDENTIFIER","KET"],t)&&t.advance(2).get().token===a},o.advance());if(u){var h=o.get().string,p=h.slice(o.get().pos+1,u.get().pos);return[w({},s,{type:a,block:U(p)}),u.advance(4)]}return[w({},s,{type:a}),o.advance()]}function c(t,e){for(var n=0;n<t.length;n++)if(!e.advance(n).ofType(t[n]))return!1;return!0}function l(t,e){for(;e.present;){if(t(e))return e;e=e.advance()}return null}function f(t){return h(t)||p(t)}function v(t){var e=f(t);return e?e[0]:null}function y(t){return v((0,k.TokenStream)(q(t)))}function x(t){for(var e=(0,k.TokenStream)(q(t)),n=[];e.present;){var r=f(e);r?(n.push(r[0]),e=r[1]):e=e.advance()}return n}function g(t){return function(e){for(var n=(0,k.TokenStream)(q(e));n.present;){var r=f(n);if(r&&t(r[0]))return r[0];n=n.advance()}return null}}function d(t,e){return g(function(t){return t.type===e})(t)}function m(t,e){return x(t).filter(function(t){return t.type===e})}var w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},E=function(){function t(t,e){var n=[],r=!0,s=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){s=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(s)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(e,"__esModule",{value:!0}),e.extractFirst=e._tokenize=void 0,e.parse=y,e.extractAll=x,e.extractFirstOfType=d,e.extractAllOfType=m;var k=n(1),T=(0,k.regex)("BRA",/</),M=(0,k.regex)("KET",/>/),A=(0,k.skip)((0,k.regex)("WHITESPACE",/\s+/)),b=(0,k.regex)("IDENTIFIER",/[a-zA-Z_][a-zA-Z0-9-_]*/),O=(0,k.regex)("KEY",/[a-zA-Z_][a-zA-Z0-9-_]*/),S=(0,k.regex)("KEYVALSEP",/:/),C=((0,k.seq)(O,(0,k.optional)(A),S),(0,k.regex)("SLASH",/\//)),N=(0,k.regex)("SIGNIFICANT_WHITESPACE",/\s+/),I=(0,k.regex)("BAREWORD",/[^,:><"\s]+/),P=(0,k.concat)("BARESTRING",(0,k.seq)(I,(0,k.repeat)((0,k.notFollowedBy)((0,k.seq)(N,I),(0,k.seq)((0,k.optional)(A),S))))),R=function(t){return JSON.parse(t.replace(/\n/g,"\\n"))},F=(0,k.regex)("COMMA",/,/),L=(0,k.regex)("NUMBER",/-?[0-9]+(\.[0-9]+)?/),B=(0,k.regex)("BOOLEAN",/(true|false)/,"i"),_=(0,k.regex)("QUOTEDSTRING",/"(\\.|[^"\\])*"/),q=(0,k.Lexer)((0,k.or)(A,T,M,F,(0,k.seq)(O,(0,k.optional)(A),S),(0,k.seq)((0,k.precededByToken)("BRA"),(0,k.optional)(A),(0,k.notFollowedBy)(b,F)),(0,k.seq)((0,k.precededByToken)("BRA"),C,(0,k.optional)(A),b,(0,k.optional)(A),M),S,L,B,_,P)),U=function(t){return t.replace(/^\n/,"").replace(/\n$/,"")};e._tokenize=function(t){return(0,k.TokenStream)(q(t))},e.extractFirst=g(function(){return!0})},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e,n,r){return{type:t,token:e,pos:n,string:r}}function i(t,e){return{tokens:t,newCharacterStream:e}}function o(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{buffer:t,pos:e,length:t.length-e,present:e<t.length,empty:e>=t.length,rest:function(){return t.slice(e)},get:function(){return t[e]},advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return o(t,e+n)},take:function(n){return t.slice(e,e+n)}}}function a(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return E({},o(t,e),{advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return a(t,e+n)},flush:function(){return a(t,t.length)},Token:function(n,r){return s(n,r,e,t)}})}function u(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=t.length>0?t[0].string:"";return E({},o(t,e),{advance:function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];return u(t,e+n)},ofType:function(n){return e<t.length&&t[e].type===n},string:n})}function h(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],r=new RegExp(/^/.source+e.source,n);return function(e,n){var s;return(s=n.rest().match(r))?i([n.Token(t,s[0])],n.advance(s[0].length)):null}}function p(t){return function(e,n){var r;return(r=t(e,n))?i([],r.newCharacterStream):null}}function c(t){return function(e,n){var r;return(r=t(e,n))?i([],r.newCharacterStream):i([],n)}}function l(t,e){return function(n,s){var o=t(n,s);if(!o)return null;var a=e([].concat(r(n),r(o.tokens)),o.newCharacterStream);return a?i([].concat(r(o.tokens),r(a.tokens)),a.newCharacterStream):null}}function f(t,e,n){var r=l(t,e);if(n){for(var s=arguments.length,i=Array(s>3?s-3:0),o=3;o<s;o++)i[o-3]=arguments[o];return f.apply(void 0,[r,n].concat(i))}return r}function v(t){return function(e,n){var r=e[e.length-1];return r&&r.type==t?i([],n):null}}function y(t,e){return function(n,r){var o;if(o=e(n,r)){return i(o.tokens.map(function(e){var n=e.type,r=e.token,i=e.pos,o=e.string;return s(n,t(r),i,o)}),o.newCharacterStream)}return null}}function x(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,n){for(var r,s=0;s<e.length;s++)if(r=e[s](t,n))return r;return null}}function g(t){return function(e,n){for(var s=[],o=0;n.present;){var a=t(s,n);if(!a)break;if(s=[].concat(r(s),r(a.tokens)),a.newCharacterStream.pos===n.pos)return i(s,a.newCharacterStream);if(o++>1e4)throw"tried to lex more than 10,000 tokens - this is probably a bug.";n=a.newCharacterStream}return i(s,n)}}function d(t,e){return function(n,r){var s=e(n,r);if(s){var o=s.tokens.map(function(t){return t.token}).join("");return i([r.Token(t,o)],s.newCharacterStream)}return null}}function m(t,e){return function(n,s){var i=t(n,s);return i?e([].concat(r(n),r(i.tokens)),i.newCharacterStream)?null:i:null}}function w(t){return function(e){var n=a(e);return g(x(t,h("UNKNOWN",/[^]*/)))([],n).tokens}}var E=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterStream=a,e.TokenStream=u,e.regex=h,e.skip=p,e.optional=c,e.seq=f,e.precededByToken=v,e.map=y,e.or=x,e.repeat=g,e.concat=d,e.notFollowedBy=m,e.Lexer=w,e.Token=s},,,,function(t,e,n){!function(e,n){t.exports=n()}(0,function(){"use strict";/*!
 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
 http://www.undefined.ch/mparser/index.html

 Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

 You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
 to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
 but don't feel like you have to let me know or ask permission.
*/
function t(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function e(t,e){this.type=t,this.value=void 0!==e&&null!==e?e:0}function n(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}function r(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function s(t,n,r,i,o){for(var a,u,h,p,c=[],l=[],f=0,v=t.length;f<v;f++){var y=t[f],x=y.type;if(x===H)c.push(y);else if(x===Q&&o.hasOwnProperty(y.value))y=new e(H,o[y.value]),c.push(y);else if(x===Z&&c.length>1)u=c.pop(),a=c.pop(),p=r[y.value],y=new e(H,p(a.value,u.value)),c.push(y);else if(x===J&&c.length>2)h=c.pop(),u=c.pop(),a=c.pop(),"?"===y.value?c.push(a.value?u.value:h.value):(p=i[y.value],y=new e(H,p(a.value,u.value,h.value)),c.push(y));else if(x===V&&c.length>0)a=c.pop(),p=n[y.value],y=new e(H,p(a.value)),c.push(y);else if(x===X){for(;c.length>0;)l.push(c.shift());l.push(new e(X,s(y.value,n,r,i,o)))}else if(x===tt&&c.length>0)a=c.pop(),c.push(new e(H,a.value[y.value]));else{for(;c.length>0;)l.push(c.shift());l.push(y)}}for(;c.length>0;)l.push(c.shift());return l}function i(t,n,r){for(var s=[],o=0,a=t.length;o<a;o++){var u=t[o],h=u.type;if(h===Q&&u.value===n)for(var p=0;p<r.tokens.length;p++){var c,l=r.tokens[p];c=l.type===V?K(l.value):l.type===Z?Y(l.value):l.type===J?z(l.value):new e(l.type,l.value),s.push(c)}else h===X?s.push(new e(X,i(u.value,n,r))):s.push(u)}return s}function o(t,e,n){for(var r,s,i,a,u=[],h=0,p=t.length;h<p;h++){var c=t[h],l=c.type;if(l===H)u.push(c.value);else if(l===Z)s=u.pop(),r=u.pop(),a=e.binaryOps[c.value],u.push(a(r,s));else if(l===J)i=u.pop(),s=u.pop(),r=u.pop(),"?"===c.value?u.push(o(r?s:i,e,n)):(a=e.ternaryOps[c.value],u.push(a(r,s,i)));else if(l===Q)if(c.value in e.functions)u.push(e.functions[c.value]);else{var f=n[c.value];if(void 0===f)throw new Error("undefined variable: "+c.value);u.push(f)}else if(l===V)r=u.pop(),a=e.unaryOps[c.value],u.push(a(r));else if(l===$){for(var v=c.value,y=[];v-- >0;)y.unshift(u.pop());if(a=u.pop(),!a.apply||!a.call)throw new Error(a+" is not a function");u.push(a.apply(void 0,y))}else if(l===X)u.push(c.value);else{if(l!==tt)throw new Error("invalid Expression");r=u.pop(),u.push(r[c.value])}}if(u.length>1)throw new Error("invalid Expression (parity)");return u[0]}function a(t,e){for(var n,s,i,o,u=[],h=0,p=t.length;h<p;h++){var c=t[h],l=c.type;if(l===H)"number"==typeof c.value&&c.value<0?u.push("("+c.value+")"):u.push(r(c.value));else if(l===Z)s=u.pop(),n=u.pop(),o=c.value,e?"^"===o?u.push("Math.pow("+n+", "+s+")"):"and"===o?u.push("(!!"+n+" && !!"+s+")"):"or"===o?u.push("(!!"+n+" || !!"+s+")"):"||"===o?u.push("(String("+n+") + String("+s+"))"):"=="===o?u.push("("+n+" === "+s+")"):"!="===o?u.push("("+n+" !== "+s+")"):u.push("("+n+" "+o+" "+s+")"):u.push("("+n+" "+o+" "+s+")");else if(l===J){if(i=u.pop(),s=u.pop(),n=u.pop(),"?"!==(o=c.value))throw new Error("invalid Expression");u.push("("+n+" ? "+s+" : "+i+")")}else if(l===Q)u.push(c.value);else if(l===V)n=u.pop(),o=c.value,"-"===o||"+"===o?u.push("("+o+n+")"):e?"not"===o?u.push("(!"+n+")"):"!"===o?u.push("fac("+n+")"):u.push(o+"("+n+")"):"!"===o?u.push("("+n+"!)"):u.push("("+o+" "+n+")");else if(l===$){for(var f=c.value,v=[];f-- >0;)v.unshift(u.pop());o=u.pop(),u.push(o+"("+v.join(", ")+")")}else if(l===tt)n=u.pop(),u.push(n+"."+c.value);else{if(l!==X)throw new Error("invalid Expression");u.push("("+a(c.value,e)+")")}}if(u.length>1)throw new Error("invalid Expression (parity)");return u[0]}function u(e,n){for(var r=0,s=e.length;r<s;r++){var i=e[r];i.type===Q&&-1===t(n,i.value)?n.push(i.value):i.type===X&&u(i.value,n)}}function h(t,e){return Number(t)+Number(e)}function p(t,e){return t-e}function c(t,e){return t*e}function l(t,e){return t/e}function f(t,e){return t%e}function v(t,e){return""+t+e}function y(t,e){return t===e}function x(t,e){return t!==e}function g(t,e){return t>e}function d(t,e){return t<e}function m(t,e){return t>=e}function w(t,e){return t<=e}function E(t,e){return Boolean(t&&e)}function k(t,e){return Boolean(t||e)}function T(t){return(Math.exp(t)-Math.exp(-t))/2}function M(t){return(Math.exp(t)+Math.exp(-t))/2}function A(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function b(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function O(t){return Math.log(t+Math.sqrt(t*t-1))}function S(t){return Math.log((1+t)/(1-t))/2}function C(t){return Math.log(t)*Math.LOG10E}function N(t){return-t}function I(t){return!t}function P(t){return t<0?Math.ceil(t):Math.floor(t)}function R(t){return Math.random()*(t||1)}function F(t){return U(t+1)}function L(t){return String(t).length}function B(){for(var t=0,e=0,n=0,r=arguments.length;n<r;n++){var s,i=Math.abs(arguments[n]);e<i?(s=e/i,t=t*s*s+1,e=i):i>0?(s=i/e,t+=s*s):t+=i}return e===1/0?1/0:e*Math.sqrt(t)}function _(t,e,n){return t?e:n}function q(t){return isFinite(t)&&t===Math.round(t)}function U(t){var e,n;if(q(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,s=t-1;r>1;)s*=r,r--;return 0===s&&(s=1),s}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*U(1-t));if(t>=171.35)return 1/0;if(t>85){var i=t*t,o=i*t,a=o*t,u=a*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*i)-139/(51840*o)-571/(2488320*a)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,n=nt[0];for(var h=1;h<nt.length;++h)n+=nt[h]/(t+h);return e=t+et+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n}function j(t,e,n,r){this.type=t,this.value=e,this.line=n,this.column=r}function G(t,e,n,r,s){this.pos=0,this.line=0,this.column=0,this.current=null,this.unaryOps=e,this.binaryOps=n,this.ternaryOps=r,this.consts=s,this.expression=t,this.savedPosition=0,this.savedCurrent=null,this.savedLine=0,this.savedColumn=0}function K(t){var n=it[t];return n||(n=it[t]=new e(V,t)),n}function Y(t){var n=ot[t];return n||(n=ot[t]=new e(Z,t)),n}function z(t){var n=at[t];return n||(n=at[t]=new e(J,t)),n}function D(t,e){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null}function W(){this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||T,cosh:Math.cosh||M,tanh:Math.tanh||A,asinh:Math.asinh||b,acosh:Math.acosh||O,atanh:Math.atanh||S,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||C,log10:Math.log10||C,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||P,"-":N,"+":Number,exp:Math.exp,not:I,length:L,"!":F},this.binaryOps={"+":h,"-":p,"*":c,"/":l,"%":f,"^":Math.pow,"||":v,"==":y,"!=":x,">":g,"<":d,">=":m,"<=":w,and:E,or:k},this.ternaryOps={"?":_},this.functions={random:R,fac:F,min:Math.min,max:Math.max,hypot:Math.hypot||B,pyt:Math.hypot||B,pow:Math.pow,atan2:Math.atan2,if:_,gamma:U},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}var H="INUMBER",V="IOP1",Z="IOP2",J="IOP3",Q="IVAR",$="IFUNCALL",X="IEXPR",tt="IMEMBER";e.prototype.toString=function(){switch(this.type){case H:case V:case Z:case J:case Q:return this.value;case $:return"CALL "+this.value;case tt:return"."+this.value;default:return"Invalid Instruction"}},n.prototype.simplify=function(t){return t=t||{},new n(s(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},n.prototype.substitute=function(t,e){return e instanceof n||(e=this.parser.parse(String(e))),new n(i(this.tokens,t,e),this.parser)},n.prototype.evaluate=function(t){return t=t||{},o(this.tokens,this,t)},n.prototype.toString=function(){return a(this.tokens,!1)},n.prototype.symbols=function(){var t=[];return u(this.tokens,t),t},n.prototype.variables=function(){var t=[];u(this.tokens,t);var e=this.functions;return t.filter(function(t){return!(t in e)})},n.prototype.toJSFunction=function(t,e){var n=this,r=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+a(this.simplify(e).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var et=4.7421875,nt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],rt="TOP";j.prototype.toString=function(){return this.type+": "+this.value},G.prototype.newToken=function(t,e,n,r){return new j(t,e,null!=n?n:this.line,null!=r?r:this.column)},G.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current,this.savedLine=this.line,this.savedColumn=this.column},G.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent,this.line=this.savedLine,this.column=this.savedColumn},G.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},G.prototype.isString=function(){var t=!1,e=this.line,n=this.column,r=this.pos,s=this.expression.charAt(r);if("'"===s||'"'===s){this.pos++,this.column++;for(var i=this.expression.indexOf(s,r+1);i>=0&&this.pos<this.expression.length;){if(this.pos=i+1,"\\"!==this.expression.charAt(i-1)){var o=this.expression.substring(r+1,i);this.current=this.newToken("TSTRING",this.unescape(o),e,n);for(var a=o.indexOf("\n"),u=-1;a>=0;)this.line++,this.column=0,u=a,a=o.indexOf("\n",a+1);this.column+=o.length-u,t=!0;break}i=this.expression.indexOf(s,i+1)}}return t},G.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken("TPAREN",t),this.pos++,this.column++,!0)},G.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken("TCOMMA",","),this.pos++,this.column++,!0)},G.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken("TNUMBER",this.consts[r]),this.pos+=r.length,this.column+=r.length,!0}return!1},G.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps)return this.current=this.newToken(rt,r),this.pos+=r.length,this.column+=r.length,!0}return!1},G.prototype.isName=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);return this.current=this.newToken("TNAME",r),this.pos+=r.length,this.column+=r.length,!0}return!1},G.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.column++,"\n"===e&&(this.line++,this.column=0),this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var st=/^[0-9a-f]{4}$/i;G.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var s=t.substring(e+1,e+5);st.test(s)||this.parseError("Illegal escape sequence: \\u"+s),n+=String.fromCharCode(parseInt(s,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var i=t.indexOf("\\",e);n+=t.substring(e,i<0?t.length:i),e=i}return n},G.prototype.isComment=function(){if("/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)){var t=this.pos;this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length);for(var e=this.expression.substring(t,this.pos),n=e.indexOf("\n");n>=0;)this.line++,this.column=e.length-n,n=e.indexOf("\n",n+1);return!0}return!1},G.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,s=n,i=this.column,o=i,a=!1,u=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!a&&"."===t);)"."===t?a=!0:u=!0,n++,i++,e=u;if(e&&(s=n,o=i),"e"===t||"E"===t){n++,i++;for(var h=!0,p=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!h||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;p=!0,h=!1}else h=!1;n++,i++}p||(n=s,i=o)}return e?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(r,n))),this.pos=n,this.column=i):(this.pos=s,this.column=o),e},G.prototype.isOperator=function(){var t=this.expression.charAt(this.pos);if("+"===t||"-"===t||"*"===t||"/"===t||"%"===t||"^"===t||"?"===t||":"===t||"."===t)this.current=this.newToken(rt,t);else if("∙"===t||"•"===t)this.current=this.newToken(rt,"*");else if(">"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(rt,">="),this.pos++,this.column++):this.current=this.newToken(rt,">");else if("<"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(rt,"<="),this.pos++,this.column++):this.current=this.newToken(rt,"<");else if("|"===t){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(rt,"||"),this.pos++,this.column++}else if("="===t){if("="!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(rt,"=="),this.pos++,this.column++}else{if("!"!==t)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(rt,"!="),this.pos++,this.column++):this.current=this.newToken(rt,t)}return this.pos++,this.column++,!0},G.prototype.parseError=function(t){throw new Error("parse error ["+(this.line+1)+":"+(this.column+1)+"]: "+t)};var it={},ot={},at={};return D.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},D.prototype.tokenMatches=function(e,n){return void 0===n||(Array.isArray(n)?t(n,e.value)>=0:"function"==typeof n?n(e):e.value===n)},D.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},D.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},D.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},D.prototype.expect=function(t,e){if(!this.accept(t,e))throw new Error("parse error ["+this.tokens.line+":"+this.tokens.column+"]: Expected "+(e||t))},D.prototype.parseAtom=function(t){if(this.accept("TNAME"))t.push(new e(Q,this.current.value));else if(this.accept("TNUMBER"))t.push(new e(H,this.current.value));else if(this.accept("TSTRING"))t.push(new e(H,this.current.value));else{if(!this.accept("TPAREN","("))throw new Error("unexpected "+this.nextToken);this.parseExpression(t),this.expect("TPAREN",")")}},D.prototype.parseExpression=function(t){this.parseConditionalExpression(t)},D.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(rt,"?");){var n=[],r=[];this.parseConditionalExpression(n),this.expect(rt,":"),this.parseConditionalExpression(r),t.push(new e(X,n)),t.push(new e(X,r)),t.push(z("?"))}},D.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(rt,"or");)this.parseAndExpression(t),t.push(Y("or"))},D.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(rt,"and");)this.parseComparison(t),t.push(Y("and"))},D.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(rt,["==","!=","<","<=",">=",">"]);){var e=this.current;this.parseAddSub(t),t.push(Y(e.value))}},D.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(rt,["+","-","||"]);){var e=this.current;this.parseTerm(t),t.push(Y(e.value))}},D.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(rt,["*","/","%"]);){var e=this.current;this.parseFactor(t),t.push(Y(e.value))}},D.prototype.parseFactor=function(t){function e(t){return t.value in n}var n=this.tokens.unaryOps;if(this.save(),this.accept(rt,e))if("-"!==this.current.value&&"+"!==this.current.value&&"TPAREN"===this.nextToken.type&&"("===this.nextToken.value)this.restore(),this.parseExponential(t);else{var r=this.current;this.parseFactor(t),t.push(K(r.value))}else this.parseExponential(t)},D.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(rt,"^");)this.parseFactor(t),t.push(Y("^"))},D.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(rt,"!");)t.push(K("!"))},D.prototype.parseFunctionCall=function(t){function n(t){return t.value in r}var r=this.tokens.unaryOps;if(this.accept(rt,n)){var s=this.current;this.parseAtom(t),t.push(K(s.value))}else for(this.parseMemberExpression(t);this.accept("TPAREN","(");)if(this.accept("TPAREN",")"))t.push(new e($,0));else{var i=this.parseArgumentList(t);t.push(new e($,i))}},D.prototype.parseArgumentList=function(t){for(var e=0;!this.accept("TPAREN",")");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},D.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(rt,".");)this.expect("TNAME"),t.push(new e(tt,this.current.value))},W.parse=function(t){return(new W).parse(t)},W.evaluate=function(t,e){return W.parse(t).evaluate(e)},W.prototype={parse:function(t){var e=[],r=new D(this,new G(t,this.unaryOps,this.binaryOps,this.ternaryOps,this.consts));return r.parseExpression(e),r.expect("TEOF","EOF"),new n(e,this)},evaluate:function(t,e){return this.parse(t).evaluate(e)}},{Parser:W,Expression:n}})},function(t,e){/*! https://mths.be/includes v0.2.0 by @mathias */
String.prototype.includes||function(){"use strict";var t={}.toString,e=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}(),n="".indexOf,r=function(e){if(null==this)throw TypeError();var r=String(this);if(e&&"[object RegExp]"==t.call(e))throw TypeError();var s=r.length,i=String(e),o=i.length,a=arguments.length>1?arguments[1]:void 0,u=a?Number(a):0;return u!=u&&(u=0),!(o+Math.min(Math.max(u,0),s)>s)&&-1!=n.call(r,i,u)};e?e(String.prototype,"includes",{value:r,configurable:!0,writable:!0}):String.prototype.includes=r}()},,function(t,e,n){var r=n(0).extractAll,s=n(5).Parser;n(6),window.lucidScripts=window.lucidScripts||{};var i=Game_Actor.prototype.expForLevel;Game_Actor.prototype.expForLevel=function(t){var e=this.currentClass(),n=r(e.note);return 0===n.length?i.call(this,t):1===t?0:isNaN(n[0].expFormula)?Math.round(s.evaluate(n[0].expFormula,{level:t})):0};var o=Game_Actor.prototype.nextLevelExp;Game_Actor.prototype.nextLevelExp=function(){var t=r(this.currentClass().note);return 0===t.length?o.call(this):isNaN(t[0].expFormula)?o.call(this):t[0].expFormula};var a=Game_Actor.prototype.levelUp;Game_Actor.prototype.levelUp=function(){if(0===r(this.currentClass().note).length)return a.call(this);a.call(this),this._exp[this._classId]=0}}]);